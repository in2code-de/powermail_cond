!function(){"use strict";function t(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw new TypeError("Private element is not present on this object")}function e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(e,i){return e.get(t(e,i))}function r(t,i,n){e(t,i),i.set(t,n)}function o(e,i,n){return e.set(t(e,i),n),n}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function a(t,e,i){return e&&l(t.prototype,e),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,i){return(e=u(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}var c=function(){return a(function t(){i(this,t)},null,[{key:"hideElement",value:function(t){null!==t&&(t.classList.add("powermail-cond-hidden"),t.style.display="none")}},{key:"showElement",value:function(t){null!==t&&(t.classList.remove("powermail-cond-hidden"),t.style.display="")}}])}(),d=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakSet,p=a(function l(a){var u,c;i(this,l),e(u=this,c=m),c.add(u),s(this,"use strict",void 0),r(this,d,void 0),r(this,h,void 0),r(this,f,"data-powermail-cond-excluded-fields"),s(this,"initialize",function(){var e=this,i="#form-"+n(d,this).querySelector("input.powermail_form_uid").value+"-actions";if(null===document.querySelector(i))t(m,e,b).call(e);else{var r=JSON.parse(document.querySelector(i).textContent);t(m,e,y).call(e,r)}t(m,e,w).call(e),t(m,e,v).call(e)}),o(d,this,a),n(d,this).powermailConditions=this,o(h,this,n(d,this).classList.contains("powermail_morestep"))});function v(){var t=this;n(d,this).addEventListener("submit",function(e){e.preventDefault(),n(d,t).classList.contains("powermail_form_error")||n(d,t).submit()})}function w(){var e=this;t(m,this,g).call(this).forEach(function(i){i.addEventListener("change",function(i){t(m,e,b).call(e)})})}function b(){var e=this;t(m,e,q).call(e);var i=new FormData(n(d,this));n(d,this).hasAttribute(n(f,this))&&n(d,this).querySelectorAll(n(d,this).getAttribute(n(f,this))).forEach(function(t){t.hasAttribute("name")&&i.delete(t.getAttribute("name"))});fetch(t(m,this,A).call(this),{body:i,method:"post"}).then(function(t){return t.json()}).then(function(i){i.loops>99?console.log("Too much loops reached by parsing conditions and rules. Check for conflicting conditions."):t(m,e,y).call(e,i)}).catch(function(t){console.log(t)})}function y(e){if(void 0!==e.todo)for(var i in e.todo)for(var r in e.todo[i])for(var o in"hide"===e.todo[i][r]["#action"]&&(n(h,this)&&c.hideElement(t(m,this,O).call(this,r)),t(m,this,k).call(this,t(m,this,x).call(this,r))),"un_hide"===e.todo[i][r]["#action"]&&(n(h,this)&&c.showElement(t(m,this,O).call(this,r)),t(m,this,_).call(this,t(m,this,x).call(this,r))),e.todo[i][r])"hide"===e.todo[i][r][o]["#action"]&&t(m,this,S).call(this,o),"un_hide"===e.todo[i][r][o]["#action"]&&t(m,this,E).call(this,o);n(d,this).querySelectorAll(".powermail_fieldset").forEach(function(t){"hidden"===window.getComputedStyle(t).visibility&&(t.style.visibility="visible",t.style.opacity=1)})}function q(){n(d,this).querySelectorAll('[disabled="disabled"]').forEach(function(t){t.removeAttribute("disabled")})}function g(){return n(d,this).querySelectorAll('input:not([data-powermail-validation="disabled"]):not([type="hidden"]):not([type="submit"]), textarea:not([data-powermail-validation="disabled"]), select:not([data-powermail-validation="disabled"])')}function A(){var t=document.querySelector("[data-condition-uri]");return null===t&&console.log("Tag with data-condition-uri not found. Maybe TypoScript was not included."),t.getAttribute("data-condition-uri")}function E(e){var i=t(m,this,P).call(this,e);null!==i&&c.showElement(i);var n=t(m,this,M).call(this,e);null!==n&&(n.removeAttribute("disabled"),t(m,this,j).call(this,n))}function S(e){var i=t(m,this,P).call(this,e);null!==i&&c.hideElement(i);var n=t(m,this,M).call(this,e);null!==n&&(n.setAttribute("disabled","disabled"),t(m,this,L).call(this,n))}function _(t){t.classList.remove("powermail-cond-hidden"),n(h,this)||c.showElement(t)}function k(t){n(h,this)?t.classList.add("powermail-cond-hidden"):c.hideElement(t)}function L(t){(t.hasAttribute("required")||t.hasAttribute("data-powermail-required"))&&(t.removeAttribute("required"),t.removeAttribute("data-powermail-required"),t.setAttribute("data-powermailcond-required","required"))}function j(e){"required"===e.getAttribute("data-powermailcond-required")&&(t(m,this,T).call(this)||t(m,this,C).call(this))&&e.setAttribute("required","required"),e.removeAttribute("data-powermailcond-required")}function C(){return"data-powermail-validate"===n(d,this).getAttribute("data-powermail-validate")}function T(){return"html5"===n(d,this).getAttribute("data-validate")}function P(e){var i=t(m,this,W).call(this,e);if(null!==i)return i;var n=t(m,this,M).call(this,e);if(null!==n){var r=n.closest(".powermail_fieldwrap");if(null!==r)return r}return console.log('Error: Could not find field by fieldMarker "'+e+'"'),null}function M(t){var e="tx_powermail_pi1[field]["+t+"]";return n(d,this).querySelector('[name="'+e+'"]:not([type="hidden"])')||n(d,this).querySelector('[name="'+e+'[]"]')}function x(t){return n(d,this).querySelector(".powermail_fieldset_"+t)}function O(t){return n(d,this).querySelector('.btn[data-powermail-fieldset="'.concat(t,'"]'))}function W(t){return n(d,this).querySelector(".powermail_fieldwrap_"+t)}window.addEventListener("pageshow",function(){document.querySelectorAll(".powermail_form").forEach(function(t){new p(t).initialize()})})}();

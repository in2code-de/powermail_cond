!function(e){function o(o){"use strict";var i=e(o),n=["powermail_input","powermail_textarea","powermail_select","powermail_radio","powermail_checkbox"],r=i.data("powermail-cond-excluded-fields-selector");this.ajaxListener=function(){a(),e(h()).on("change",function(){a()})};var t=function(o){if(void 0!==o.todo)for(var i in o.todo){var n=e(".powermail_form_"+i);for(var r in o.todo[i]){n.find(".powermail_fieldset_"+r);"hide"===o.todo[i][r]["#action"]&&l(w(r,n)),"un_hide"===o.todo[i][r]["#action"]&&p(w(r,n));for(var t in o.todo[i][r])"hide"===o.todo[i][r][t]["#action"]&&f(t,n),"un_hide"===o.todo[i][r][t]["#action"]&&c(t,n)}}},a=function(){var o=e(i.get(0)),n=o.find(":disabled").prop("disabled",!1),a=new FormData(i.get(0));if(n.prop("disabled",!0),"undefined"!=typeof r){var d=o.find(r);d.each(function(){var o=e(this).attr("name");a["delete"](o)})}e.ajax({type:"POST",url:s(),data:a,contentType:!1,processData:!1,success:function(e){100===e.loops&&q("100 loops reached by parsing conditions and rules. Maybe there are conflicting conditions."),t(e)}})},d=function(e){(e.prop("required")||e.data("parsley-required"))&&(e.prop("required",!1),e.removeAttr("data-parsley-required"),e.data("powermailcond-required","required"))},u=function(e){"required"===e.data("powermailcond-required")&&(y()?e.prop("required","required"):_()&&e.prop("required","required")),e.removeData("powermailcond-required")},c=function(e,o){var i=o.find(".powermail_fieldwrap_"+e);i.show();var n=m(e,o);n.prop("disabled",!1),u(n)},f=function(e,o){var i=o.find(".powermail_fieldwrap_"+e);i.hide();var n=m(e,o);n.prop("disabled",!0),d(n)},p=function(e){e.show()},l=function(e){e.hide()},s=function(){var o=e("*[data-condition-uri]").data("condition-uri");return void 0===o&&q("Tag with data-condition-uri not found. Maybe TypoScript was not included."),o},m=function(e,o){return o.find('[name^="tx_powermail_pi1[field]['+e+']"]').not('[type="hidden"]')},w=function(e,o){return o.find(".powermail_fieldset_"+e)},v=function(e,o,i){o="undefined"!=typeof o?o:"",i="undefined"!=typeof i?i:",";for(var n="",r=0;r<e.length;r++)r>0&&(n+=i),n+=o+e[r];return n},h=function(){return v(n,".")},_=function(){return"data-parsley-validate"===i.data("parsley-validate")},y=function(){return"html5"===i.data("validate")},q=function(e){"object"==typeof console&&("string"==typeof e&&(e="powermail_cond: "+e),console.log(e))}}e(document).ready(function(){e("form.powermail_form").each(function(){new o(this).ajaxListener()})})}(jQuery);